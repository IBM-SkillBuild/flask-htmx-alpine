<div class="alert alert-success" id="api-data-container">
  <h5>Â¡Datos cargados exitosamente!</h5>
  <p>Mensaje: Hola desde la API</p>
  <p>Status: success</p>
  <small class="text-muted">Cargado dinÃ¡micamente con HTMX</small>

  <hr />

  <div class="text-center">
    <button class="btn btn-outline-secondary btn-sm" onclick="closeApiData()">
      âŒ Cerrar
    </button>
  </div>
</div>

<script>
  // FunciÃ³n global para cerrar/eliminar el contenido del DOM
  window.closeApiData = function () {
    console.log("ğŸ” closeApiData() ejecutÃ¡ndose...");

    const apiResponse = document.getElementById("api-response");
    console.log("ğŸ” Elemento #api-response encontrado:", apiResponse);

    if (apiResponse) {
      console.log(
        "ğŸ” Contenido antes de limpiar:",
        apiResponse.innerHTML.length,
        "caracteres"
      );
      apiResponse.innerHTML = "";
      console.log(
        "ğŸ” Contenido despuÃ©s de limpiar:",
        apiResponse.innerHTML.length,
        "caracteres"
      );
    } else {
      console.error("âŒ No se encontrÃ³ el elemento #api-response");
    }

    // Mostrar el botÃ³n de API nuevamente
    const appElement = document.querySelector("[x-data]");
    console.log("ğŸ” Elemento Alpine encontrado:", appElement);

    if (appElement && appElement._x_dataStack && appElement._x_dataStack[0]) {
      appElement._x_dataStack[0].showApiButton = true;
      console.log("âœ… showApiButton cambiado a true");
    } else {
      console.error("âŒ No se pudo acceder al store de Alpine.js");
    }

    console.log("âŒ FunciÃ³n closeApiData() completada");
  };

  // Ejecutar despuÃ©s de que HTMX haya terminado de cargar el contenido
  document.addEventListener("htmx:afterSettle", function (event) {
    // Verificar si este evento es para nuestro contenido de API
    if (event.target.querySelector("#api-data-container")) {
      // Scroll suave
      if (typeof fluidScroll !== "undefined") {
        fluidScroll({
          yPos: "end",
          easing: "easeOutQuart",
          duration: 1500,
        });
      }

      console.log("ğŸš€ Script de API data inicializado despuÃ©s de HTMX settle");
    }
  });
</script>
